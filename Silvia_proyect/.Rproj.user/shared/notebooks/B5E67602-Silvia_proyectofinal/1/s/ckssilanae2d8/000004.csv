"0","# Simular las coordenadas de ubicación para 10 grupos de murciélagos "
"0","ubi_groups <- function(leaf_coors, groups, radius_constant = 6){"
"0","  "
"0","    if (groups >= nrow(leaf_coors)){"
"0","    cat(crayon::green('No se puede tener más grupos q hojas \n'))"
"0","  stop()"
"0","}"
"0","# Determinamos el tamaño  para los 10 grupos, usamos una probabilidaded 0.6 para que los tamaños de grupo tengan  sentido según lo visto  en la naturaleza  "
"0","  "
"0","  group_sizes <- rbinom(n = groups, 10, prob = 0.6)"
"0","  "
"0","# extraemos una hoja central para cada grupo  "
"0","  leaves <- sample(1:nrow(leaf_coors), length(group_sizes))"
"0","# obtenemos  las coordenanadas para cada hoja central "
"0","  centers <- leaf_coors[leaves, ]  "
"0","  "
"0","  centers$group_size <- group_sizes"
"0",""
"0","  centers$leaves <- leaves"
"0","  "
"0","# Se calculan todas las distancias posibles entre la hoja central  mediante una matriz de distancia  entre las hojas disponibles."
"0","  dist_leaves <- as.matrix(dist(leaf_coors))"
"0","  "
"0","  group_leaves_l <- lapply(1:nrow(centers), function(x){"
"0","    "
"0","    dists_to_center <- dist_leaves[centers$leaves[x], ]"
"0","    "
"0","# Se seleccionan las hojas  cuya distancia al centro sea menor que el tamaño del grupo multiplicado por un radio constante  "
"0","    selec_leaves <- dists_to_center[dists_to_center < centers$group_size[x] * radius_constant] "
"0","    "
"0","# Se crea un data frame de las hojas selecionadas y sus respectivas coordenadas "
"0","    selec_leaves_df <- leaf_coors[names(selec_leaves), ]"
"0","    "
"0","    selec_leaves_df$leaf_id <- names(selec_leaves)"
"0","    "
"0","    selec_leaves_df$dist_to_center <- selec_leaves"
"0","    "
"0","    selec_leaves_df$group_size <- centers$group_size[x]"
"0","    "
"0","    selec_leaves_df$id <- x"
"0","    "
"0","    return(selec_leaves_df)"
"0","    "
"0","  })"
"0","  group_leaves <- do.call(rbind, group_leaves_l)"
"0","  "
"0"," return(group_leaves)"
"0","}"
